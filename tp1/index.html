<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Les Travaux Pratiques du cours eServices"><meta name=author content="Lilia Sfaxi"><link href=http://INSATunisia.github.io/TP-eServices/tp1/ rel=canonical><link rel=icon href=../img/favicon.ico><meta name=generator content="mkdocs-1.2.3, mkdocs-material-8.1.10"><title>TP1 - Services Web REST et SOAP avec Talend - TP eServices</title><link rel=stylesheet href=../assets/stylesheets/main.d6be258b.min.css><link rel=stylesheet href=../assets/stylesheets/palette.e6a45f82.min.css><meta name=theme-color content=#e92063><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../css/timeago.css><link rel=stylesheet href=../stylesheets/extra.css><link rel=stylesheet href=../stylesheets/links.css><script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme data-md-color-primary=pink data-md-color-accent=amber> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#tp1-services-web-rest-et-soap-avec-talend class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title="TP eServices" class="md-header__button md-logo" aria-label="TP eServices" data-md-component=logo> <img src=../img/logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> TP eServices </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> TP1 - Services Web REST et SOAP avec Talend </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/INSATunisia/TP-eServices/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> INSATunisia/TP-eServices </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title="TP eServices" class="md-nav__button md-logo" aria-label="TP eServices" data-md-component=logo> <img src=../img/logo.png alt=logo> </a> TP eServices </label> <div class=md-nav__source> <a href=https://github.com/INSATunisia/TP-eServices/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> INSATunisia/TP-eServices </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> Travaux Pratiques eServices </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> TP1 - Services Web REST et SOAP avec Talend <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> TP1 - Services Web REST et SOAP avec Talend </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#tp1-services-web-rest-et-soap-avec-talend class=md-nav__link> TP1 - Services Web REST et SOAP avec Talend </a> <nav class=md-nav aria-label="TP1 - Services Web REST et SOAP avec Talend"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#telecharger-pdf class=md-nav__link> Télécharger PDF </a> </li> <li class=md-nav__item> <a href=#objectifs-du-tp class=md-nav__link> Objectifs du TP </a> </li> <li class=md-nav__item> <a href=#outils-et-versions class=md-nav__link> Outils et Versions </a> </li> <li class=md-nav__item> <a href=#talend-esb class=md-nav__link> Talend ESB </a> </li> <li class=md-nav__item> <a href=#talend-open-studio-for-esb class=md-nav__link> Talend Open Studio for ESB </a> </li> <li class=md-nav__item> <a href=#service-web-soap-helloworld class=md-nav__link> Service Web SOAP : Helloworld </a> <nav class=md-nav aria-label="Service Web SOAP : Helloworld"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#creer-le-service-soap class=md-nav__link> Créer le service SOAP </a> </li> <li class=md-nav__item> <a href=#configurer-le-service-soap class=md-nav__link> Configurer le service SOAP </a> </li> <li class=md-nav__item> <a href=#tester-le-service-soap class=md-nav__link> Tester le service SOAP </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#consommateur-du-webservice-soap class=md-nav__link> Consommateur du WebService SOAP </a> </li> <li class=md-nav__item> <a href=#service-web-rest-interrogation-dune-base-de-donnees class=md-nav__link> Service Web REST : Interrogation d'une base de données </a> <nav class=md-nav aria-label="Service Web REST : Interrogation d'une base de données"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#creation-de-la-base-de-donnees class=md-nav__link> Création de la base de données </a> </li> <li class=md-nav__item> <a href=#ajout-de-la-connexion-a-la-base-avec-talend class=md-nav__link> Ajout de la connexion à la base avec Talend </a> </li> <li class=md-nav__item> <a href=#creation-du-service-rest class=md-nav__link> Création du service REST </a> </li> <li class=md-nav__item> <a href=#configuration-du-service-rest class=md-nav__link> Configuration du service REST </a> <nav class=md-nav aria-label="Configuration du service REST"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#configuration-de-trestrequest class=md-nav__link> Configuration de tRestRequest </a> </li> <li class=md-nav__item> <a href=#configuration-de-user class=md-nav__link> Configuration de user </a> </li> <li class=md-nav__item> <a href=#configuration-de-txmlmap class=md-nav__link> Configuration de tXMLMap </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#tester-le-service class=md-nav__link> Tester le Service </a> <nav class=md-nav aria-label="Tester le Service"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#dans-un-navigateur class=md-nav__link> Dans un navigateur </a> </li> <li class=md-nav__item> <a href=#avec-soapui class=md-nav__link> Avec SOAPUI </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#tester-le-service-soap_1 class=md-nav__link> Tester le service SOAP </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#consommateur-du-webservice-rest class=md-nav__link> Consommateur du WebService REST </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../tp2/ class=md-nav__link> TP2 - Orchestration de Services avec Camunda </a> </li> <li class=md-nav__item> <a href=../tp3/ class=md-nav__link> TP3 - Mise en Place d’un ESB avec Talend ESB </a> </li> <li class=md-nav__item> <a href=../tp4/ class=md-nav__link> TP4 - Microservices avec Spring Boot et Spring Cloud </a> </li> <li class=md-nav__item> <a href=../tp5/ class=md-nav__link> TP5 - API Management avec Atom et Anypoint </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#tp1-services-web-rest-et-soap-avec-talend class=md-nav__link> TP1 - Services Web REST et SOAP avec Talend </a> <nav class=md-nav aria-label="TP1 - Services Web REST et SOAP avec Talend"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#telecharger-pdf class=md-nav__link> Télécharger PDF </a> </li> <li class=md-nav__item> <a href=#objectifs-du-tp class=md-nav__link> Objectifs du TP </a> </li> <li class=md-nav__item> <a href=#outils-et-versions class=md-nav__link> Outils et Versions </a> </li> <li class=md-nav__item> <a href=#talend-esb class=md-nav__link> Talend ESB </a> </li> <li class=md-nav__item> <a href=#talend-open-studio-for-esb class=md-nav__link> Talend Open Studio for ESB </a> </li> <li class=md-nav__item> <a href=#service-web-soap-helloworld class=md-nav__link> Service Web SOAP : Helloworld </a> <nav class=md-nav aria-label="Service Web SOAP : Helloworld"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#creer-le-service-soap class=md-nav__link> Créer le service SOAP </a> </li> <li class=md-nav__item> <a href=#configurer-le-service-soap class=md-nav__link> Configurer le service SOAP </a> </li> <li class=md-nav__item> <a href=#tester-le-service-soap class=md-nav__link> Tester le service SOAP </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#consommateur-du-webservice-soap class=md-nav__link> Consommateur du WebService SOAP </a> </li> <li class=md-nav__item> <a href=#service-web-rest-interrogation-dune-base-de-donnees class=md-nav__link> Service Web REST : Interrogation d'une base de données </a> <nav class=md-nav aria-label="Service Web REST : Interrogation d'une base de données"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#creation-de-la-base-de-donnees class=md-nav__link> Création de la base de données </a> </li> <li class=md-nav__item> <a href=#ajout-de-la-connexion-a-la-base-avec-talend class=md-nav__link> Ajout de la connexion à la base avec Talend </a> </li> <li class=md-nav__item> <a href=#creation-du-service-rest class=md-nav__link> Création du service REST </a> </li> <li class=md-nav__item> <a href=#configuration-du-service-rest class=md-nav__link> Configuration du service REST </a> <nav class=md-nav aria-label="Configuration du service REST"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#configuration-de-trestrequest class=md-nav__link> Configuration de tRestRequest </a> </li> <li class=md-nav__item> <a href=#configuration-de-user class=md-nav__link> Configuration de user </a> </li> <li class=md-nav__item> <a href=#configuration-de-txmlmap class=md-nav__link> Configuration de tXMLMap </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#tester-le-service class=md-nav__link> Tester le Service </a> <nav class=md-nav aria-label="Tester le Service"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#dans-un-navigateur class=md-nav__link> Dans un navigateur </a> </li> <li class=md-nav__item> <a href=#avec-soapui class=md-nav__link> Avec SOAPUI </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#tester-le-service-soap_1 class=md-nav__link> Tester le service SOAP </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#consommateur-du-webservice-rest class=md-nav__link> Consommateur du WebService REST </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/INSATunisia/TP-eServices/edit/master/docs/tp1.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg> </a> <h1>TP1 - Services Web REST et SOAP avec Talend</h1> <h2 id=tp1-services-web-rest-et-soap-avec-talend>TP1 - Services Web REST et SOAP avec Talend<a class=headerlink href=#tp1-services-web-rest-et-soap-avec-talend title="Permanent link">&para;</a></h2> <p><img alt="Web Services" src=../img/ws.png></p> <h3 id=telecharger-pdf>Télécharger PDF<a class=headerlink href=#telecharger-pdf title="Permanent link">&para;</a></h3> <p><a href=../tp1.pdf><img alt="Download TP1" src=../img/pdf.png></a></p> <h3 id=objectifs-du-tp>Objectifs du TP<a class=headerlink href=#objectifs-du-tp title="Permanent link">&para;</a></h3> <p>Création et consommation de web services SOAP et REST en utilisant l'outil Talend.</p> <h3 id=outils-et-versions>Outils et Versions<a class=headerlink href=#outils-et-versions title="Permanent link">&para;</a></h3> <ul> <li><a href=https://www.talend.com/download_page_type/talend-open-studio/ >Talend Open Studio for ESB</a> Version: 7.2</li> <li><a href=http://www.oracle.com/technetwork/java/javase/downloads/index-jsp-138363.html>Java</a> Version 1.8</li> <li><a href=https://dev.mysql.com/downloads/ >MySQL</a> Version 5.7</li> <li><a href=https://www.soapui.org/downloads/soapui.html>SOAPUI</a> Version 5.3</li> </ul> <h3 id=talend-esb>Talend ESB<a class=headerlink href=#talend-esb title="Permanent link">&para;</a></h3> <p>Talend ESB est une solution légère, robuste et modulaire pour la création de services web sécurisés ainsi que pour l’intégration d’applications nouvelles ou existantes. Talend participe au développement des composants ESB à travers la communauté Apache. Il collabore avec un grand nombre de développeurs de la communauté Apache et a fait plusieurs contributions aux projets Apache. Talend fournit:</p> <ul> <li>Un courtier de messages à haute performance.</li> <li>Des options de déploiement flexibles</li> <li>Des outils de développement pour Eclipse</li> <li>Une interface utilisateur pour l’intégration et la médiation d’applications</li> <li>Support pour les services web SOAP et REST</li> <li>La médiation et le routage</li> <li>Support pour le failover, le monitoring et la sécurité</li> </ul> <p>L’environnement d’exécution standard de Talend ESB est un conteneur OSGi. L’implémentation OSGi fournie avec Talend ESB est Apache Karaf, avec Eclipse Equinox comme environnement d’exécution OSGi. Elle fournit un conteneur léger dans lequel les différents composants et applications peuvent être déployées.</p> <h3 id=talend-open-studio-for-esb>Talend Open Studio for ESB<a class=headerlink href=#talend-open-studio-for-esb title="Permanent link">&para;</a></h3> <p>Talend Open Studio for ESB (TOS-ESB) fournit une interface graphique de développement pour implémenter, compiler, tester et publier des services Web Java, des applications REST, des services de données et des routes de messages. Le déploiement d’applications avec TOS-ESB utilise principalement les trois blocs représentés dans cette figure:</p> <p><img alt=Talend src=../img/tp1/talend.png></p> <ul> <li>Le bloc bleu représente l’API Talend Studio, où il est possible d’intégrer des données, des services ou des applications</li> <li>Les blocs rouges représentent un ou plusieurs environnements d’exécution Talend déployés dans votre système d’information. Il vous permet de déployer et d’exécuter les Jobs, les routes et les services créés dans Talend Studio. Il est possible d’avoir plusieurs environnements d’exécution, entre lesquels vous pouvez basculer grâce à Talend Service Locator.</li> <li>Le bloc orange est une base de données de monitoring, permettant de stocker les informations d’exécution des processus et de l’activité des services.</li> </ul> <p>L’interface utilisateur de TOS-ESB se présente comme suit:</p> <p><img alt=TOS src=../img/tp1/tos.png></p> <table> <thead> <tr> <th>Composant</th> <th>Fonctionnalité</th> </tr> </thead> <tbody> <tr> <td><img alt=1 src=../img/tp1/1.png></td> <td>Le traditionnel <em>Repository</em> contenant vos Jobs, services, fichiers, routes…</td> </tr> <tr> <td><img alt=2 src=../img/tp1/2.png></td> <td>La fenêtre principale, représentant graphiquement la composition de vos jobs et routes</td> </tr> <tr> <td><img alt=3 src=../img/tp1/3.png></td> <td>La fenêtre contenant les propriétés, la console d’exécution…</td> </tr> <tr> <td><img alt=4 src=../img/tp1/4.png></td> <td>La palette des composants à utiliser</td> </tr> <tr> <td><img alt=5 src=../img/tp1/5.png></td> <td>Les onglets pour le choix de la perspective à utiliser</td> </tr> </tbody> </table> <h3 id=service-web-soap-helloworld>Service Web SOAP : Helloworld<a class=headerlink href=#service-web-soap-helloworld title="Permanent link">&para;</a></h3> <p>Nous ne pouvons pas configurer un ESB avant de savoir créer, déployer et exécuter des services web avec les outils Talend ESB. Nous allons donc commencer avec le traditionnel Hello World. Pour cela, il faut commencer par créer un projet de votre choix. Dans toute cette partie, nous nous trouverons dans la perspective Integration.</p> <h4 id=creer-le-service-soap>Créer le service SOAP<a class=headerlink href=#creer-le-service-soap title="Permanent link">&para;</a></h4> <p>Pour créer un nouveau service de type SOAP:</p> <ul> <li>Clic-droit sur <em>Services</em> de votre Repository, et choisir <em>Create Service</em>. Appeler le service <em>HelloWorldService</em>. Cliquer sur Suivant.</li> <li>On vous propose soit de créer un nouveau WSDL, soit de choisir un WSDL existant. Dans notre cas, nous créons un nouveau WSDL. Cliquer sur Terminer.</li> <li>Un service simple qui reçoit une chaîne de caractères et en produit une autre est créé. Une vue graphique de son WSDL s’affiche.</li> </ul> <p><img alt="HelloWorld Service" src=../img/tp1/hw-soap.png></p> <h4 id=configurer-le-service-soap>Configurer le service SOAP<a class=headerlink href=#configurer-le-service-soap title="Permanent link">&para;</a></h4> <p>Pour pouvoir configurer votre service, il faut créer un Job. Mais d’abord:</p> <ul> <li>Importer le WSDL de votre service dans votre repository. Pour cela, clic droit sur <em>HelloWorldService</em>, et choisir <em>Importer les schémas WSDL</em>. Vous retrouverez votre WSDL dans la partie <em>Metadonnées -&gt; Fichier XML</em>.</li> <li>Créer un nouveau Job pour votre service. Pour cela, clic-droit sur l’opération <em>HelloWorldServiceOperation</em> (sous Services) et choisir <em>Assign Job</em>.</li> <li>Modifier votre Job pour qu’il ait l’allure suivante (Le <em>tLogRow</em> nous permettra d’afficher le résultat du service exécuté sur la console avant de l’envoyer au consommateur):</li> </ul> <p><img alt="HelloWorld Job" src=../img/tp1/hw-job.png></p> <div class="admonition tip"> <p class=admonition-title>Astuce</p> <p>Il est conseillé de relier d'abord les composants <em>tXMLMap</em> et <em>tESBProviderResponse_1</em>, puis d'insérer le <em>tLogRow</em>. On vous demandera en reliant les deux premiers composants : <em>Récupérer le schéma du composant cible?</em>. Cliquer sur <em>Oui</em>.</p> </div> <ul> <li> <p>Configurer votre tXMLMap pour que le <em>in</em> de la requête soit transmise au <em>out</em> de la réponse, en lui concaténant le célèbre "Hello". Pour cela:</p> <ul> <li>Double clic sur votre XML Map.</li> <li>Clic-droit sur <em>payload</em> de l’entrée, et cliquer sur <em>Import from Repository</em>.</li> <li>Choisir le <em>HelloWorldServiceOperationRequest</em> correspondant au fichier WSDL que vous avez généré.</li> <li>Refaire les mêmes étapes pour le payload de la sortie, en choisissant <em>HelloWorldServiceOperationResponse</em>.</li> <li>Relier le <em>in</em> de la requête avec le <em>out</em> de la réponse (créer l’entrée comme sous-élément de la réponse)</li> <li>Modifier l’expression du <em>out</em> en ajoutant la chaîne <strong>“Hello “</strong> avant la valeur <em>in</em> de l’entrée.</li> <li>Le résultat de la XMLMap devrait ressembler à ce qui suit:</li> </ul> <p><img alt="XML Map" src=../img/tp1/hw-xml-map.png></p> <ul> <li>Sauvegarder et quitter.</li> </ul> </li> <li> <p>Lancer votre Job (cela permettra de publier votre service web sur le port 8090). Vérifier que votre fichier WSDL existe bien.</p> </li> </ul> <h4 id=tester-le-service-soap>Tester le service SOAP<a class=headerlink href=#tester-le-service-soap title="Permanent link">&para;</a></h4> <p>Il est possible de tester votre service de plusieurs manières. L'une d'elles est d'utiliser un outil léger de test appelé <em>SOAPUI</em>.</p> <ul> <li>Lancer SOAPUI</li> <li>Cliquer sur l'icône SOAP en haut de la fenêtre principale</li> <li>Donner un nom au projet (par exemple Helloworld) et entrer l'adresse du fichier WSDL du service, comme suit:</li> </ul> <p><img alt="SOAPUI SOAP Project" src=../img/tp1/soapui-soap-project.png></p> <ul> <li>Double cliquer sur la requête générée, et remplir le <em><in>?</in></em> par un nom de votre choix.</li> <li>Cliquer sur la flèche verte. Le résultat devra ressembler au suivant:</li> </ul> <p><img alt="SOAPUI request-response" src=../img/tp1/soapui-soap-req-resp.png></p> <h3 id=consommateur-du-webservice-soap>Consommateur du WebService SOAP<a class=headerlink href=#consommateur-du-webservice-soap title="Permanent link">&para;</a></h3> <p>Nous allons maintenant créer un consommateur pour notre service avec talend open studio. Pour cela:</p> <ul> <li>Créer un nouveau Job, que vous appellerez <em>HelloWorldServiceConsumer</em>.</li> <li>Concevez votre job de manière à ce qu’il ait l’allure suivante:</li> </ul> <p><img alt="Soap Consommateur Job" src=../img/tp1/hw-conso.png></p> <ul> <li> <p>Voici les rôles des éléments que vous avez ajouté :</p> <ul> <li><strong>tFixedFlowInput</strong> : définir les entrées à envoyer à votre service</li> <li><strong>tXMLMap</strong> : associer les entrées définies aux entrées du service</li> <li><strong>tESBConsumer</strong> : consommateur du service</li> <li><strong>tLogRow</strong>: afficher les réponses et/ou les fautes (s’il y’en a)</li> </ul> </li> <li> <p>Configurer votre composant <em>tFixedFlowInput</em>. Pour cela:</p> <ul> <li>Cliquer sur <em>Modifier le schéma</em> et ajouter une colonne appelée <em>Nom</em> de type <em>String</em>.</li> <li>Utiliser une <em>Inline Table</em> pour ajouter les trois chaînes en entrée: “Alice”, “Bob” et “Chuck”.</li> </ul> </li> <li> <p>Configurer votre <em>tESBConsumer</em> en lui donnant comme WSDL celui du service que vous avez créé. Vérifiez bien que le Endpoint soit sur le port 8090.</p> </li> <li>Configurer votre <em>tXMLMap</em> pour que la variable <em>Nom</em> soit associée au <em>in</em> de votre service.</li> <li>Exécuter le Job, et observez le résultat. Votre console devrait afficher le résultat suivant:</li> </ul> <p><img alt="Helloworld Résultat" src=../img/tp1/hw-result.png></p> <h3 id=service-web-rest-interrogation-dune-base-de-donnees>Service Web REST : Interrogation d'une base de données<a class=headerlink href=#service-web-rest-interrogation-dune-base-de-donnees title="Permanent link">&para;</a></h3> <p>Nous allons maintenant montrer comment exposer un service REST pour interroger une base de données.</p> <h4 id=creation-de-la-base-de-donnees>Création de la base de données<a class=headerlink href=#creation-de-la-base-de-donnees title="Permanent link">&para;</a></h4> <p>Nous allons commencer par créer une base de données (MySQL dans mon cas), appelée <em>eservices-tp1</em> avec une table, que nous appellerons <em>user</em>. Cette table contient les champs <em>id</em>, <em>firstname</em> et <em>lastname</em>. Remplir ensuite la base à votre guise, de manière à avoir au moins 4 entrées.</p> <p>Elle devra ressembler à ce qui suit:</p> <p><img alt="Base de données" src=../img/tp1/rest-db.png></p> <h4 id=ajout-de-la-connexion-a-la-base-avec-talend>Ajout de la connexion à la base avec Talend<a class=headerlink href=#ajout-de-la-connexion-a-la-base-avec-talend title="Permanent link">&para;</a></h4> <p>Pour configurer une connexion à cette base de données avec Talend, suivre les étapes suivantes:</p> <ul> <li>Dans les Métadonnées, sous <em>Connexions aux bases de données</em>, clic-droit, puis choisir: <em>Créer une connexion</em>.</li> <li>Configurer votre connexion. Voici un exemple:</li> </ul> <p><img alt="Configuration de la base de données" src=../img/tp1/rest-bd-config.png></p> <ul> <li>Une fois la connexion créée, importer son schéma. Pour cela, clic-droit sur Metadonnées -&gt; Connexions... -&gt; <strong><nom-connexion></strong> et choisir: <em>Récupérer le schéma</em>.</li> <li>Sélectionner la table <em>user</em>, et vérifier que les champs sont bien chargés dans la partie Schéma.</li> </ul> <h4 id=creation-du-service-rest>Création du service REST<a class=headerlink href=#creation-du-service-rest title="Permanent link">&para;</a></h4> <p>Nous allons maintenant créer le service REST. Pour cela, créer un nouveau job, qu'on appellera <em>DBService</em>, puis glisser les composants suivants:</p> <ul> <li><strong>tRestRequest</strong> : Pour définir la requête REST que le client doit appeler</li> <li><strong>user</strong> : Table de la base de données. Dans la nouvelle connexion à la base de données que vous avez créé, sous <em>Schémas des tables</em>, glisser la table <em>user</em> vers le Job, puis choisir tMySQLInput dans la fenêtre de choix qui apparaît.</li> </ul> <div class="admonition tip"> <p class=admonition-title>Remarque</p> <p>Je choisis <em>tMySQLInput</em> car, dans mon cas, c'est une base de données MySQL, et je veux juste lire son contenu, je vais donc y accéder en entrée (d'où le <em>Input</em>).</p> </div> <ul> <li><strong>tFlowToIterate</strong> : Pour effectuer une itération sur les données d'entrée et génèrer des variables globales.</li> <li><strong>tXMLMap</strong> : Permet de router et transformer les flux entrants de la base de données vers le résultat de la requête.</li> <li><strong>tRestResponse</strong> : Pour définir la réponse à envoyer à l'utilisateur suite à sa requête.</li> <li><strong>tLogRow</strong> : Pour le log, bien sûr.</li> </ul> <p>Le job aura l'allure suivante:</p> <p><img alt="Service REST" src=../img/tp1/rest-service.png></p> <h4 id=configuration-du-service-rest>Configuration du service REST<a class=headerlink href=#configuration-du-service-rest title="Permanent link">&para;</a></h4> <p>Nous désirons configurer le service de manière à ce que, quand un consommateur appelle l'URI: <code>http://localhost:8088/users?from=1&amp;to=3</code>, le service retourne une réponse contenant les utilisateurs (id, nom et prénom) de la base de données dont les ids figurent entre 1 et 3.</p> <h5 id=configuration-de-trestrequest>Configuration de tRestRequest<a class=headerlink href=#configuration-de-trestrequest title="Permanent link">&para;</a></h5> <p>tRestRequest devra être configuré comme suit:</p> <ul> <li>La valeur de <em>Endpoint URL</em> devra être: <code>"http://localhost:8088/users"</code></li> <li>Si vous avez connecté le tRestRequest avec le tFlowToIterate avec un lien appelé <em>getUsers</em>, vous devriez le retrouver dans la case <em>REST API Mapping</em>. Sinon, créez-le.</li> <li>Garder les informations par défaut de ce mapping (méthode GET, URI /, Produit XML ou JSON).</li> <li>En cliquant sur <em>getUsers</em>, un bouton avec trois petits points apparaît. Cliquez dessus.</li> <li> <p>Ajouter les deux colonnes <em>from</em> et <em>to</em> représentant les deux paramètres de la requête. Prenez soin à ce que:</p> <ul> <li>Leur type soit <em>int</em></li> <li>Leurs valeurs par défaut soient respectivement 1 et 3.</li> </ul> <div class="admonition tip"> <p class=admonition-title>Remarque</p> <p>Ces valeurs seront utilisées dans le cas où le consommateur n'introduit pas de paramètres.</p> </div> <ul> <li>Leur commentaire ait la valeur: <em>query</em></li> </ul> <div class="admonition tip"> <p class=admonition-title>Remarque</p> <p>Cela indique que ces champs sont des paramètres de requête, pas définies dans le Path.</p> </div> </li> </ul> <h5 id=configuration-de-user>Configuration de user<a class=headerlink href=#configuration-de-user title="Permanent link">&para;</a></h5> <p>Puisque le composant <em>user</em> a été créé à partir de la connexion à votre base MySQL, il contient déjà les informations de connexion nécessaires.</p> <p>Il suffira dans notre cas de:</p> <ul> <li>Cliquer sur <em>Guess Schema</em> pour charger le schéma de la base.</li> <li>Changer la requête pour qu'elle soit comme suit:</li> </ul> <div class=highlight><pre><span></span><code><span class=ss>&quot;SELECT * FROM `user` where id&gt;=&quot;</span><span class=o>+</span><span class=n>globalMap</span><span class=p>.</span><span class=k>get</span><span class=p>(</span><span class=ss>&quot;getUsers.from&quot;</span><span class=p>)</span><span class=o>+</span><span class=w></span>
<span class=w>                      </span><span class=ss>&quot; and id&lt;=&quot;</span><span class=o>+</span><span class=n>globalMap</span><span class=p>.</span><span class=k>get</span><span class=p>(</span><span class=ss>&quot;getUsers.to&quot;</span><span class=p>)</span><span class=w></span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Remarque</p> <p>globalMap est une variable globale permettant de stocker les informations de la requête, comme par exemple ses paramètres.</p> </div> <h5 id=configuration-de-txmlmap>Configuration de tXMLMap<a class=headerlink href=#configuration-de-txmlmap title="Permanent link">&para;</a></h5> <p>Cliquer deux fois sur la <em>tXMLMap</em> pour la configurer.</p> <ul> <li>Dans la colonne de droite, ajouter (si ce n'est déjà fait) une colonne intitulée <em>body</em> dont le type est <em>Document</em>.</li> <li>Cette colonne contient un élément <em>root</em>. Renommer cet élément pour <em>users</em>.</li> <li>Ajouter un sous-élément à <em>users</em> appelé <em>user</em>.</li> <li>Définir cet élément comme <em>loop Element</em>.</li> <li>Glisser-déplacer l'id de la colonne en entrée vers le <em>user</em>. Créez-le comme attribut du noeud cible.</li> <li>De même pour le <em>firstname</em> et <em>lastname</em>, qui seront, eux, des sous-éléments du noeud <em>user</em>.</li> <li>Dans la colonne de droite, cliquer sur la petite clef à molette (<img alt src=../img/tp1/clef-molette.png>). Mettre la valeur de "All in one" à <em>true</em>. Cela permettra à toutes les données XML d'être écrites dans un seul flux.</li> </ul> <p>La configuration finale sera donc comme suit:</p> <p><img alt="tXMLMap du Service REST" src=../img/tp1/rest-txmlmap.png></p> <div class="admonition tip"> <p class=admonition-title>Indication</p> <p>La configuration précédente va générer une réponse de la forme suivante:</p> <div class=highlight><pre><span></span><code><span class=nt>&lt;users&gt;</span>
  <span class=nt>&lt;user</span> <span class=na>id=</span><span class=s>1</span><span class=nt>&gt;</span>
    <span class=nt>&lt;firstname&gt;</span> flen <span class=nt>&lt;/firstname&gt;</span>
    <span class=nt>&lt;lastname&gt;</span> fouleni <span class=nt>&lt;/lastname&gt;</span>
  <span class=nt>&lt;/user&gt;</span>
  <span class=nt>&lt;user</span> <span class=na>id=</span><span class=s>2</span><span class=nt>&gt;</span>
    <span class=nt>&lt;firstname&gt;</span> flena <span class=nt>&lt;/firstname&gt;</span>
    <span class=nt>&lt;lastname&gt;</span> foulenia <span class=nt>&lt;/lastname&gt;</span>
  <span class=nt>&lt;/user&gt;</span>
<span class=nt>&lt;users&gt;</span>
</code></pre></div> </div> <p>Les autres composants devront rester tels qu'ils sont par défaut. Il suffira maintenant de lancer le service, en cliquant sur <em>Exécuter</em>.</p> <h4 id=tester-le-service>Tester le Service<a class=headerlink href=#tester-le-service title="Permanent link">&para;</a></h4> <h5 id=dans-un-navigateur>Dans un navigateur<a class=headerlink href=#dans-un-navigateur title="Permanent link">&para;</a></h5> <p>Pour tester le service, il suffit d'ouvrir un navigateur, et de taper la requête de votre choix.</p> <p>Par exemple, la requête suivante : <code>http://localhost:8088/users?from=2&amp;to=4</code> donnera:</p> <p><div class=highlight><pre><span></span><code>  <span class=nt>&lt;users&gt;</span>
      <span class=nt>&lt;user</span> <span class=na>id=</span><span class=s>&quot;2&quot;</span><span class=nt>&gt;</span>
          <span class=nt>&lt;firstname&gt;</span>Souad<span class=nt>&lt;/firstname&gt;</span>
          <span class=nt>&lt;lastname&gt;</span>Mezghenni<span class=nt>&lt;/lastname&gt;</span>
      <span class=nt>&lt;/user&gt;</span>
      <span class=nt>&lt;user</span> <span class=na>id=</span><span class=s>&quot;3&quot;</span><span class=nt>&gt;</span>
          <span class=nt>&lt;firstname&gt;</span>Mourad<span class=nt>&lt;/firstname&gt;</span>
          <span class=nt>&lt;lastname&gt;</span>Lahwel<span class=nt>&lt;/lastname&gt;</span>
      <span class=nt>&lt;/user&gt;</span>
      <span class=nt>&lt;user</span> <span class=na>id=</span><span class=s>&quot;4&quot;</span><span class=nt>&gt;</span>
          <span class=nt>&lt;firstname&gt;</span>Monia<span class=nt>&lt;/firstname&gt;</span>
          <span class=nt>&lt;lastname&gt;</span>Landolsi<span class=nt>&lt;/lastname&gt;</span>
      <span class=nt>&lt;/user&gt;</span>
  <span class=nt>&lt;/users&gt;</span>
</code></pre></div> Si aucun paramètre n'est indiqué: <code>http://localhost:8088/users</code> cela donnera:</p> <div class=highlight><pre><span></span><code>  <span class=nt>&lt;users&gt;</span>
      <span class=nt>&lt;user</span> <span class=na>id=</span><span class=s>&quot;1&quot;</span><span class=nt>&gt;</span>
          <span class=nt>&lt;firstname&gt;</span>Ahmed<span class=nt>&lt;/firstname&gt;</span>
          <span class=nt>&lt;lastname&gt;</span>Ramzi<span class=nt>&lt;/lastname&gt;</span>
      <span class=nt>&lt;/user&gt;</span>
      <span class=nt>&lt;user</span> <span class=na>id=</span><span class=s>&quot;2&quot;</span><span class=nt>&gt;</span>
          <span class=nt>&lt;firstname&gt;</span>Souad<span class=nt>&lt;/firstname&gt;</span>
          <span class=nt>&lt;lastname&gt;</span>Mezghenni<span class=nt>&lt;/lastname&gt;</span>
      <span class=nt>&lt;/user&gt;</span>
      <span class=nt>&lt;user</span> <span class=na>id=</span><span class=s>&quot;3&quot;</span><span class=nt>&gt;</span>
          <span class=nt>&lt;firstname&gt;</span>Mourad<span class=nt>&lt;/firstname&gt;</span>
          <span class=nt>&lt;lastname&gt;</span>Lahwel<span class=nt>&lt;/lastname&gt;</span>
      <span class=nt>&lt;/user&gt;</span>
  <span class=nt>&lt;/users&gt;</span>
</code></pre></div> <h5 id=avec-soapui>Avec SOAPUI<a class=headerlink href=#avec-soapui title="Permanent link">&para;</a></h5> <h4 id=tester-le-service-soap_1>Tester le service SOAP<a class=headerlink href=#tester-le-service-soap_1 title="Permanent link">&para;</a></h4> <p>Il est possible de tester votre service REST avec <em>SOAPUI</em>.</p> <ul> <li>Lancer SOAPUI</li> <li>Cliquer sur l'icône REST en haut de la fenêtre principale</li> <li>Entrer l'URI que vous désirez tester: <code>http://localhost:8088/users?from=2&amp;to=4</code></li> <li>La fenêtre suivante devrait apparaître:</li> </ul> <p><img alt="SOAPUI REST request" src=../img/tp1/soapui-rest-req.png></p> <ul> <li>Cliquer sur la flèche verte. Le résultat devra ressembler au suivant:</li> </ul> <p><img alt="SOAPUI REST request-response" src=../img/tp1/soapui-rest-req-resp.png></p> <h3 id=consommateur-du-webservice-rest>Consommateur du WebService REST<a class=headerlink href=#consommateur-du-webservice-rest title="Permanent link">&para;</a></h3> <p>Pour créer un consommateur pour le web service REST avec Talend, il suffit de créer le Job suivant:</p> <p><img alt="Consommateur REST" src=../img/tp1/rest-consumer.png></p> <p>Configurer le <em>tRestClient</em> comme suit:</p> <p><img alt="Configuration du consommateur REST" src=../img/tp1/rest-cons-config.png></p> <p>Exécuter. Le résultat devrait ressembler à ceci:</p> <p><img alt="Résultat du consommateur REST" src=../img/tp1/rest-cons-result.png></p> <hr> <div class=md-source-file> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class=timeago datetime=2019-09-23T18:36:46+01:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2019-09-23</span> </small> </div> </article> </div> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=.. class="md-footer__link md-footer__link--prev" aria-label="Previous: Travaux Pratiques eServices" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Travaux Pratiques eServices </div> </div> </a> <a href=../tp2/ class="md-footer__link md-footer__link--next" aria-label="Next: TP2 - Orchestration de Services avec Camunda" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> TP2 - Orchestration de Services avec Camunda </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2017 - 2018 Lilia Sfaxi </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.092fa1f6.min.js"}</script> <script src=../assets/javascripts/bundle.e3b2bf44.min.js></script> <script src=../js/timeago.min.js></script> <script src=../js/timeago_mkdocs_material.js></script> </body> </html>